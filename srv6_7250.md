# 7250 IXR - SRv6

Configuration required on 7250 IXR for SRv6 support

## A. Configuration

### 1. SRv6 locator configuration

```cpp
(gl)[/configure router "Base" segment-routing]
A:admin@R16-IXR# info
    segment-routing-v6 {
        source-address 2001:ac9:10::1
        micro-segment {
            block-length 32
            global-sid-entries 56
            sid-length 16
            block "SRv6-uSID-Alg0" {
                admin-state enable
                prefix {
                    ip-prefix 2001:ac9::/32
                }
                static-function {
                    max-entries 16
                }
            }
        }
        micro-segment-locator "uSID-Alg0-Locator" {
            admin-state enable
            block "SRv6-uSID-Alg0"
            un {
                value 16
            }

        }-
        base-routing-instance {
            micro-segment-locator "uSID-Alg0-Locator" {
                function {
                    ua-auto-allocate psp protection protected { }
                }
            }
        }
    }
```


### 2. ISIS configuration

The ISIS section includes prefix-unreachable (UPA), and the uSID Locator.
```cpp
(gl)[/configure router "Base" isis 1]
A:admin@R16-IXR# info
    admin-state enable
    advertise-router-capability as
    ipv6-routing native
    level-capability 1
    standard-multi-instance true
    traffic-engineering true
    area-address [49.1022.2222.22]
    multi-topology {
        ipv6-unicast true
    }
    loopfree-alternate {
        remote-lfa {
        }
        ti-lfa {
        }
    }
```
```cpp
    prefix-unreachable {
        process-received-upa true
        upa-lifetime 120
        upa-metric 4261412865
    }
    segment-routing-v6 {
        admin-state enable
        micro-segment-locator "uSID-Alg0-Locator" {
            level-capability 1
            level 1 {
                metric 1
            }
        }
    }
```
```cpp
    interface "system" {
        interface-type point-to-point
    }
    interface "to-R15" {
        interface-type point-to-point
    }
    level 1 {
        wide-metrics-only true
    }
```

### 3. Service Configuration

#### 3.1 Inter-domain ELINE (Epipe)

```cpp
(ro)[/configure service epipe "R05-R16_VPWS-SRv6"]
A:admin@R16-IXR# info
    admin-state enable
    service-id 516
    customer "1"
    segment-routing-v6 1 {
        micro-segment-locator "uSID-Alg0-Locator" {
            function {
                udx2 {
                }
            }
        }
    }
    sap 1/1/c2/1:516 {
    }
    bgp-evpn {
        evi 516
        local-attachment-circuit "local-ac" {
            eth-tag 165
        }
        remote-attachment-circuit "remote-ac" {
            eth-tag 516
        }
        segment-routing-v6 1 {
            admin-state enable
            srv6 {
                instance 1
                default-locator "uSID-Alg0-Locator"
            }
            route-next-hop {
                system-ipv6
            }
        }
    }
```

## B. Status

### 1. Routing

Locator uSID
```cpp
A:admin@R16-IXR# /show router segment-routing-v6 micro-segment-locator 
===============================================================================
Micro Segment Locator uSID-Alg0-Locator
===============================================================================
Admin State                  : Up
Oper State                   : Up
Block                        : SRv6-uSID-Alg0
Flex Algorithm               : 
uN
  Value                      : 16
  Oper Value                 : 16
  SID                        : 2001:ac9:10::
  SRH-mode                   : PSP
-------------------------------------------------------------------------------
Micro Segment Locators  : 1
-------------------------------------------------------------------------------
```

Local uSID for all functions
```cpp
A:admin@R16-IXR# /show router segment-routing-v6 micro-segment-local-sid

===============================================================================
Micro Segment Routing v6 Local SIDs
===============================================================================
SID                                               Type           Function
  Micro Segment Locator                                          
  Context                                                        
-------------------------------------------------------------------------------
2001:ac9:10::                                     uN             16
  uSID-Alg0-Locator
  None
2001:ac9:10:e010::                                uDX2           57360
  uSID-Alg0-Locator
  SvcId: 516 Name: R05-R16_VPWS-SRv6
2001:ac9:10:e011::                                uDX2           57361
  uSID-Alg0-Locator
  SvcId: 1316 Name: R13-R16_VPWS-SRv6
2001:ac9:10:e013::                                uA             57363
  uSID-Alg0-Locator
  None
-------------------------------------------------------------------------------
SIDs : 4
-------------------------------------------------------------------------------
===============================================================================
```

Received locators
```cpp
A:admin@R16-IXR# /show router isis 1 segment-routing-v6 micro-segment-locator

===============================================================================
Rtr Base ISIS Instance 1 SRv6 Micro Segment Locator Table
===============================================================================
Prefix                             AdvRtr                        MT     Lvl/Typ
 AttributeFlags                     Tag                           Flags  Algo
-------------------------------------------------------------------------------
2001:ac8::/32                      R11-SR                        0      1/Int.
  -                                  21                            -      0
2001:ac8::/32                      R12-SR                        0      1/Int.
  -                                  21                            -      0
2001:ac9:d::/48                    R13-IXR-a                     0      1/Int.
  -                                  0                             -      0
2001:ac9:e::/48                    R14-IXR                       0      1/Int.
  -                                  0                             -      0
2001:ac9:f::/48                    R15-IXR-a                     0      1/Int.
  -                                  0                             -      0
2001:ac9:10::/48                   R16-IXR                       0      1/Int.
  -                                  0                             -      0
-------------------------------------------------------------------------------
No. of Micro Segment Locators: 6
-------------------------------------------------------------------------------
AttributeFlags: X    = External Prefix
                R    = Re-advertisement
                N    = Node
                E    = ELC
                A    = Anycast
Flags:          D    = Down
===============================================================================
```

### 2. Services

#### 2.1 Inter-domain ELINE (Epipe)

Status

```cpp
A:admin@R16-IXR# /show service id "R05-R16_VPWS-SRv6" base

===============================================================================
Service Basic Information
===============================================================================
Service Id        : 516                 Vpn Id            : 0
Service Type      : Epipe               
MACSec enabled    : no                  
Name              : R05-R16_VPWS-SRv6
Description       : (Not Specified)
Customer Id       : 1                   Creation Origin   : manual
Last Status Change: 09/02/2025 20:35:18 
Last Mgmt Change  : 09/02/2025 20:32:47 
Admin State       : Up                  Oper State        : Up
MTU               : 1514                
Vc Switching      : False               
SAP Count         : 1                   SDP Bind Count    : 0
Per Svc Hashing   : Disabled            
Ignore MTU Mismat*: Disabled            
Force QTag Fwd    : Disabled            
Oper Group        : <none>              
 
-------------------------------------------------------------------------------
Service Access & Destination Points
-------------------------------------------------------------------------------
Identifier                               Type         AdmMTU  OprMTU  Adm  Opr
-------------------------------------------------------------------------------
sap:1/1/c2/1:516                         q-tag        1518    1518    Up   Up
===============================================================================
* indicates that the corresponding row element may have been truncated.
```

Announced SID for this service
```cpp
A:admin@R16-IXR# /show service id "R05-R16_VPWS-SRv6" segment-routing-v6 detail

===============================================================================
Micro Segment Routing v6 Instance 1 Service 516
===============================================================================
Micro Segment Locator
 Type          Function  SID                                     Status
               Oper Func                                         
-------------------------------------------------------------------------------
uSID-Alg0-Locator
 uDX2          *-        2001:ac9:10:e010::                      ok
               57360                                             
===============================================================================
Legend: * - System allocated
```

Remote SID for this service received from R05
```cpp
A:admin@R16-IXR# /show service id "R05-R16_VPWS-SRv6" segment-routing-v6 destinations

===============================================================================
TEP, SID (Instance 1)
===============================================================================
TEP Address                             Segment Id
-------------------------------------------------------------------------------
3ffe::c                                 2001:ac8:5:e012::
-------------------------------------------------------------------------------
Number of TEP, SID: 1
-------------------------------------------------------------------------------
===============================================================================

===============================================================================
Segment Routing v6 Ethernet Segment Dest (Instance 1)
===============================================================================
Eth SegId                                 Num. Macs     Last Update
-------------------------------------------------------------------------------
No Matching Entries
===============================================================================
```

uSID for this service
```cpp
A:admin@R16-IXR# show router bgp routes evpn auto-disc tag 516 detail 
===============================================================================
 BGP Router ID:10.0.20.16       AS:65000       Local AS:65000      
===============================================================================
 Legend -
 Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
                 l - leaked, x - stale, > - best, b - backup, p - purge,
                 w - unused-weight-only
 Origin codes  : i - IGP, e - EGP, ? - incomplete

===============================================================================
BGP EVPN Auto-Disc Routes
===============================================================================
Original Attributes
 
Network        : n/a
Nexthop        : 3ffe::c
Path Id        : None                   
From           : 3ffe::c
Res. Nexthop   : fe80::1e59:eff:fe00:85
Local Pref.    : 100                    Interface Name : to-R15
Aggregator AS  : None                   Aggregator     : None
Atomic Aggr.   : Not Atomic             MED            : None
AIGP Metric    : None                   IGP Cost       : 31
Connector      : None
Community      : target:65000:516 l2-attribute:MTU: 1514 V: 0 M: 0 F: 0 C: 0
                 P: 0 B: 0
Cluster        : 10.0.0.12 10.0.0.7
Originator Id  : 10.0.0.5               Peer Router Id : 10.0.0.12
Origin         : IGP                    
Flags          : Used Valid Best 
Route Source   : Internal
AS-Path        : No As-Path
EVPN type      : AUTO-DISC              
ESI            : ESI-0
Tag            : 516                    
Route Dist.    : 10.0.0.5:516           
MPLS Label     : 57362                  
Route Tag      : 0                      
Neighbor-AS    : n/a
DB Orig Val    : N/A                    Final Orig Val : N/A
Add Paths Send : Default                
Last Modified  : 23h08m53s              
SRv6 TLV Type  : SRv6 L2 Service TLV (6)
SRv6 SubTLV    : SRv6 SID Information (1)
Sid            : 2001:ac8:5::
Full Sid       : 2001:ac8:5:e012::
Behavior       : End.uDX2 (65)
SRv6 SubSubTLV : SRv6 SID Structure (1)
Loc-Block-Len  : 32                     Loc-Node-Len   : 16
Func-Len       : 16                     Arg-Len        : 0
Tpose-Len      : 16                     Tpose-offset   : 48
 
Modified Attributes
 
Network        : n/a
Nexthop        : 3ffe::c
Path Id        : None                   
From           : 3ffe::c
Res. Nexthop   : fe80::1e59:eff:fe00:85
Local Pref.    : 100                    Interface Name : to-R15
Aggregator AS  : None                   Aggregator     : None
Atomic Aggr.   : Not Atomic             MED            : None
AIGP Metric    : None                   IGP Cost       : 31
Connector      : None
Community      : target:65000:516 l2-attribute:MTU: 1514 V: 0 M: 0 F: 0 C: 0
                 P: 0 B: 0
Cluster        : 10.0.0.12 10.0.0.7
Originator Id  : 10.0.0.5               Peer Router Id : 10.0.0.12
Origin         : IGP                    
Flags          : Used Valid Best 
Route Source   : Internal
AS-Path        : No As-Path
EVPN type      : AUTO-DISC              
ESI            : ESI-0
Tag            : 516                    
Route Dist.    : 10.0.0.5:516           
MPLS Label     : 57362                  
Route Tag      : 0                      
Neighbor-AS    : n/a
DB Orig Val    : N/A                    Final Orig Val : N/A
Add Paths Send : Default                
Last Modified  : 23h08m53s              
SRv6 TLV Type  : SRv6 L2 Service TLV (6)
SRv6 SubTLV    : SRv6 SID Information (1)
Sid            : 2001:ac8:5::
Full Sid       : 2001:ac8:5:e012::
Behavior       : End.uDX2 (65)
SRv6 SubSubTLV : SRv6 SID Structure (1)
Loc-Block-Len  : 32                     Loc-Node-Len   : 16
Func-Len       : 16                     Arg-Len        : 0
Tpose-Len      : 16                     Tpose-offset   : 48
 
-------------------------------------------------------------------------------
Original Attributes
 
Network        : n/a
Nexthop        : 3ffe::b
Path Id        : None                   
From           : 3ffe::b
Res. Nexthop   : fe80::1e59:eff:fe00:85
Local Pref.    : 100                    Interface Name : to-R15
Aggregator AS  : None                   Aggregator     : None
Atomic Aggr.   : Not Atomic             MED            : None
AIGP Metric    : None                   IGP Cost       : 31
Connector      : None
Community      : target:65000:516 l2-attribute:MTU: 1514 V: 0 M: 0 F: 0 C: 0
                 P: 0 B: 0
Cluster        : 10.0.0.11 10.0.0.12 10.0.0.7
Originator Id  : 10.0.0.5               Peer Router Id : 10.0.0.11
Origin         : IGP                    
Flags          : Valid Best 
TieBreakReason : ClusterList            
Route Source   : Internal
AS-Path        : No As-Path
EVPN type      : AUTO-DISC              
ESI            : ESI-0
Tag            : 516                    
Route Dist.    : 10.0.0.5:516           
MPLS Label     : 57362                  
Route Tag      : 0                      
Neighbor-AS    : n/a
DB Orig Val    : N/A                    Final Orig Val : N/A
Add Paths Send : Default                
Last Modified  : 23h08m53s              
SRv6 TLV Type  : SRv6 L2 Service TLV (6)
SRv6 SubTLV    : SRv6 SID Information (1)
Sid            : 2001:ac8:5::
Full Sid       : 2001:ac8:5:e012::
Behavior       : End.uDX2 (65)
SRv6 SubSubTLV : SRv6 SID Structure (1)
Loc-Block-Len  : 32                     Loc-Node-Len   : 16
Func-Len       : 16                     Arg-Len        : 0
Tpose-Len      : 16                     Tpose-offset   : 48
 
Modified Attributes
 
Network        : n/a
Nexthop        : 3ffe::b
Path Id        : None                   
From           : 3ffe::b
Res. Nexthop   : fe80::1e59:eff:fe00:85
Local Pref.    : 100                    Interface Name : to-R15
Aggregator AS  : None                   Aggregator     : None
Atomic Aggr.   : Not Atomic             MED            : None
AIGP Metric    : None                   IGP Cost       : 31
Connector      : None
Community      : target:65000:516 l2-attribute:MTU: 1514 V: 0 M: 0 F: 0 C: 0
                 P: 0 B: 0
Cluster        : 10.0.0.11 10.0.0.12 10.0.0.7
Originator Id  : 10.0.0.5               Peer Router Id : 10.0.0.11
Origin         : IGP                    
Flags          : Valid Best 
TieBreakReason : ClusterList            
Route Source   : Internal
AS-Path        : No As-Path
EVPN type      : AUTO-DISC              
ESI            : ESI-0
Tag            : 516                    
Route Dist.    : 10.0.0.5:516           
MPLS Label     : 57362                  
Route Tag      : 0                      
Neighbor-AS    : n/a
DB Orig Val    : N/A                    Final Orig Val : N/A
Add Paths Send : Default                
Last Modified  : 23h08m53s              
SRv6 TLV Type  : SRv6 L2 Service TLV (6)
SRv6 SubTLV    : SRv6 SID Information (1)
Sid            : 2001:ac8:5::
Full Sid       : 2001:ac8:5:e012::
Behavior       : End.uDX2 (65)
SRv6 SubSubTLV : SRv6 SID Structure (1)
Loc-Block-Len  : 32                     Loc-Node-Len   : 16
Func-Len       : 16                     Arg-Len        : 0
Tpose-Len      : 16                     Tpose-offset   : 48
 
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------
Routes : 2
===============================================================================
```

Full SID matches what is seen in R05 with SID `2001:ac8:5:e012::`
```cpp
A:admin@R05-SR# /show router segment-routing-v6 micro-segment-local-sid

===============================================================================
Micro Segment Routing v6 Local SIDs
===============================================================================
SID                                               Type           Function
  Micro Segment Locator                                          
  Context                                                        
-------------------------------------------------------------------------------
2001:ac8:5::                                      uN             5
  uSID-Alg0-Locator
  None
2001:ac8:5:e010::                                 uDX2           57360
  uSID-Alg0-Locator
  SvcId: 4 Name: R05-R11_VPWS-SRv6
2001:ac8:5:e011::                                 uDX2           57361
  uSID-Alg0-Locator
  SvcId: 413 Name: R04-R13_VPWS-SRv6
2001:ac8:5:e012::                                 uDX2           57362
  uSID-Alg0-Locator
  SvcId: 516 Name: R05-R16_VPWS-SRv6
2001:ac8:5:e015::                                 uA             57365
  uSID-Alg0-Locator
  None
2001:ac8:5:e016::                                 uA             57366
  uSID-Alg0-Locator
  None
-------------------------------------------------------------------------------
SIDs : 6
-------------------------------------------------------------------------------
===============================================================================
```

Routing Table
```cpp
A:admin@R16-IXR# /show router route-table ipv6 2001:ac8:5:e012::

===============================================================================
IPv6 Route Table (Router: Base)
===============================================================================
Dest Prefix[Flags]                            Type    Proto     Age        Pref
      Next Hop[Interface Name]                                    Metric   
-------------------------------------------------------------------------------
2001:ac8::/32                                 Remote  ISIS(1)   00h34m07s  15
       2001:ac8::/32 (tunneled:SRV6-ISIS)                           31
-------------------------------------------------------------------------------
No. of Routes: 1
Flags: n = Number of times nexthop is repeated
       B = BGP backup route available
       L = LFA nexthop available
       S = Sticky ECMP requested
===============================================================================
```

Tunnel Table
```cpp
A:admin@R16-IXR# /show router tunnel-table ipv6                  

===============================================================================
IPv6 Tunnel Table (Router: Base)
===============================================================================
Destination                                     Owner     Encap TunnelId  Pref
Nexthop                                         Color           Metric    
-------------------------------------------------------------------------------
2001:ac8::/32                                   srv6-isis SRV6  524293    0
  fe80::1e59:eff:fe00:85-"to-R15"                                 31        
2001:ac9:d::/48                                 srv6-isis SRV6  524290    0
  fe80::1e59:eff:fe00:85-"to-R15"                                 21        
2001:ac9:e::/48                                 srv6-isis SRV6  524291    0
  fe80::1e59:eff:fe00:85-"to-R15"                                 21        
2001:ac9:f::/48                                 srv6-isis SRV6  524292    0
  fe80::1e59:eff:fe00:85-"to-R15"                                 11        
2001:ac9:e013::/48                              srv6-isis SRV6  524289    0
  fe80::1e59:eff:fe00:85-"to-R15"                                 10        
-------------------------------------------------------------------------------
Flags: B = BGP or MPLS backup hop available
       L = Loop-Free Alternate (LFA) hop available
       E = Inactive best-external BGP route
       k = RIB-API or Forwarding Policy backup hop
===============================================================================
```

IPv6 FIB
```cpp
A:admin@R16-IXR# show router fib 1 ipv6

===============================================================================
FIB Display
===============================================================================
Prefix [Flags]                                              Protocol
  NextHop                                                   
-------------------------------------------------------------------------------
2001:ac8::/32                                               ISIS
  2001:ac8::/32 (Transport:SRV6-ISIS:524293)
2001:ac9:d::/48                                             ISIS
  2001:ac9:d::/48 (Transport:SRV6-ISIS:524290)
2001:ac9:e::/48                                             ISIS
  2001:ac9:e::/48 (Transport:SRV6-ISIS:524291)
2001:ac9:f::/48                                             ISIS
  2001:ac9:f::/48 (Transport:SRV6-ISIS:524292)
2001:ac9:10::/48                                            SRV6
  Blackhole                                                 
2001:ac9:10:e010::/128                                      SRV6
  Blackhole                                                 
2001:ac9:10:e011::/128                                      SRV6
  Blackhole                                                 
2001:ac9:10:e013::/64                                       ISIS
  2001:ac9:e013::/48 (Transport:SRV6-ISIS:524289)
2001:ac9:e013::/48                                          ISIS
  2001:ac9:e013::/48 (Transport:SRV6-ISIS:524289)
3ffe::5/128                                                 ISIS
  fe80::1e59:eff:fe00:85 (to-R15)
3ffe::6/128                                                 ISIS
  fe80::1e59:eff:fe00:85 (to-R15)
3ffe::7/128                                                 ISIS
  fe80::1e59:eff:fe00:85 (to-R15)
3ffe::8/128                                                 ISIS
  fe80::1e59:eff:fe00:85 (to-R15)
3ffe::9/128                                                 ISIS
  fe80::1e59:eff:fe00:85 (to-R15)
3ffe::a/128                                                 ISIS
  fe80::1e59:eff:fe00:85 (to-R15)
3ffe::b/128                                                 ISIS
  fe80::1e59:eff:fe00:85 (to-R15)
3ffe::c/128                                                 ISIS
  fe80::1e59:eff:fe00:85 (to-R15)
3ffe::d/128                                                 ISIS
  fe80::1e59:eff:fe00:85 (to-R15)
3ffe::e/128                                                 ISIS
  fe80::1e59:eff:fe00:85 (to-R15)
3ffe::f/128                                                 ISIS
  fe80::1e59:eff:fe00:85 (to-R15)
3ffe::10/128                                                LOCAL
  3ffe::10 (system)
-------------------------------------------------------------------------------
Total Entries : 21
-------------------------------------------------------------------------------
===============================================================================
```