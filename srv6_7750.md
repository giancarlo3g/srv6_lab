# 7550 IXR - SRv6

Configuration required on 7750 SR for SRv6 support

## A. Configuration

### 1. SRv6 locator configuration

In 7750, an FPE is required for SRv6. We use a configuration group to make it simpler.
```cpp
    group "SRv6-7750" {
        card 1 {
            card-type iom-1
            mda 1 {
                xconnect {
                    mac 1 {
                        loopback 1 {
                        }
                    }
                }
            }
        }
        fwd-path-ext {
            fpe 1 {
                path {
                    pxc 1
                }
                application {
                    srv6 {
                        type origination
                    }
                }
            }
            fpe 2 {
                path {
                    pxc 2
                }
                application {
                    srv6 {
                        type termination
                    }
                }
            }
        }
        port pxc-1.a {
            admin-state enable
        }
        port pxc-1.b {
            admin-state enable
        }
        port pxc-2.a {
            admin-state enable
        }
        port pxc-2.b {
            admin-state enable
        }
        port 1/1/m1/1 {
            admin-state enable
        }
        port-xc {
            pxc 1 {
                admin-state enable
                port-id 1/1/m1/1
            }
            pxc 2 {
                admin-state enable
                port-id 1/1/m1/1
            }
        }
    }
```
```cpp
/configure apply-groups ["SRv6-7750"]
```

Base Routing 
```cpp
(gl)[/configure router "Base" segment-routing]
A:admin@R05-SR# info
    segment-routing-v6 {
        origination-fpe [1]
        source-address 2001:db8:0:5::1
        micro-segment {
            block-length 32
            global-sid-entries 56
            sid-length 16
            block "SRv6-uSID-Alg0" {
                admin-state enable
                termination-fpe [2]
                label-block "SRv6-uSID-Alg0"
                prefix {
                    ip-prefix 2001:ac8::/32
                }
                static-function {
                    max-entries 16
                }
            }
        }
        micro-segment-locator "uSID-Alg0-Locator" {
            admin-state enable
            block "SRv6-uSID-Alg0"
            un {
                value 5
            }
        }
        base-routing-instance {
            micro-segment-locator "uSID-Alg0-Locator" {
                function {
                    ua-auto-allocate psp protection protected { }
                }
            }
        }
    }
```


### 2. ISIS configuration

```cpp
(gl)[/configure router "Base" isis 0]
A:admin@R05-SR# info
    admin-state enable
    advertise-router-capability as
```
```cpp
    ipv6-routing native
```
```cpp
    level-capability 2
    standard-multi-instance true
    traffic-engineering true
    area-address [49.1000.0000.00]
```
```cpp  
    multi-topology {
        ipv6-unicast true
    }
```
```cpp
    loopfree-alternate {
        remote-lfa {
        }
        ti-lfa {
        }
    }
```
```cpp
    segment-routing-v6 {
        admin-state enable
        micro-segment-locator "uSID-Alg0-Locator" {
            level-capability 2
            level 2 {
                metric 1
            }
        }
    }
```
```cpp
    interface "system" {
        interface-type point-to-point
    }
    interface "toR06" {
        interface-type point-to-point
    }
    interface "toR07" {
        interface-type point-to-point
    }
    level 2 {
        wide-metrics-only true
    }
```

### 3. Service Configuration

#### 3.1 Inter-domain ELINE (Epipe)

```cpp
(gl)[/configure service epipe "R05-R16_VPWS-SRv6"]
A:admin@R05-SR# info
    admin-state enable
    service-id 516
    customer "1"
    segment-routing-v6 1 {
        micro-segment-locator "uSID-Alg0-Locator" {
            function {
                udx2 {
                }
            }
        }
    }
    sap 1/1/c4/1:516 {
    }
    bgp-evpn {
        evi 516
        local-attachment-circuit "local-ac" {
            eth-tag 516
        }
        remote-attachment-circuit "remote-ac" {
            eth-tag 165
        }
        segment-routing-v6 1 {
            admin-state enable
            srv6 {
                instance 1
                default-locator "uSID-Alg0-Locator"
            }
            route-next-hop {
                system-ipv6
            }
        }
    }
```

## B. Status

### 1. Routing

Locator uSID
```cpp
A:admin@R05-SR# /show router segment-routing-v6 micro-segment-locator 
===============================================================================
Micro Segment Locator uSID-Alg0-Locator
===============================================================================
Admin State                  : Up
Oper State                   : Up
Block                        : SRv6-uSID-Alg0
Flex Algorithm               : 
uN
  Value                      : 5
  Oper Value                 : 5
  SID                        : 2001:ac8:5::
  SRH-mode                   : PSP
-------------------------------------------------------------------------------
Micro Segment Locators  : 1
-------------------------------------------------------------------------------
```

Local uSID for all functions
```cpp
A:admin@R05-SR#  /show router segment-routing-v6 micro-segment-local-sid

===============================================================================
Micro Segment Routing v6 Local SIDs
===============================================================================
SID                                               Type           Function
  Micro Segment Locator                                          
  Context                                                        
-------------------------------------------------------------------------------
2001:ac8:5::                                      uN             5
  uSID-Alg0-Locator
  None
2001:ac8:5:e010::                                 uA             57360
  uSID-Alg0-Locator
  None
2001:ac8:5:e011::                                 uDX2           57361
  uSID-Alg0-Locator
  SvcId: 413 Name: R04-R13_VPWS-SRv6
2001:ac8:5:e012::                                 uDX2           57362
  uSID-Alg0-Locator
  SvcId: 4 Name: R05-R11_VPWS-SRv6
2001:ac8:5:e013::                                 uA             57363
  uSID-Alg0-Locator
  None
2001:ac8:5:e014::                                 uDX2           57364
  uSID-Alg0-Locator
  SvcId: 516 Name: R05-R16_VPWS-SRv6
-------------------------------------------------------------------------------
SIDs : 6
-------------------------------------------------------------------------------
===============================================================================
```

Received locators
```cpp
A:admin@R05-SR# /show router isis segment-routing-v6 micro-segment-locator

===============================================================================
Rtr Base ISIS Instance 0 SRv6 Micro Segment Locator Table
===============================================================================
Prefix                             AdvRtr                        MT     Lvl/Typ
 AttributeFlags                     Tag                           Flags  Algo
-------------------------------------------------------------------------------
2001:ac8:5::/48                    R05-SR                        0      2/Int.
  -                                  0                             -      0
2001:ac8:6::/48                    R06-SR                        0      2/Int.
  -                                  0                             -      0
2001:ac8:7::/48                    R07-SR                        0      2/Int.
  -                                  0                             -      0
2001:ac8:8::/48                    R08-SR                        0      2/Int.
  -                                  0                             -      0
2001:ac8:9::/48                    R09-SR                        0      2/Int.
  -                                  0                             -      0
2001:ac8:a::/48                    R10-SR                        0      2/Int.
  -                                  0                             -      0
2001:ac8:b::/48                    R11-SR                        0      2/Int.
  -                                  0                             -      0
2001:ac8:c::/48                    R12-SR                        0      2/Int.
  -                                  0                             -      0
-------------------------------------------------------------------------------
No. of Micro Segment Locators: 8
-------------------------------------------------------------------------------
AttributeFlags: X    = External Prefix
                R    = Re-advertisement
                N    = Node
                E    = ELC
                A    = Anycast
Flags:          D    = Down
===============================================================================
```

### 2. Services

#### 2.1 Inter-domain ELINE (Epipe)

Status

```cpp
A:admin@R05-SR# /show service id "R05-R16_VPWS-SRv6" base

===============================================================================
Service Basic Information
===============================================================================
Service Id        : 516                 Vpn Id            : 0
Service Type      : Epipe               
MACSec enabled    : no                  
Name              : R05-R16_VPWS-SRv6
Description       : (Not Specified)
Customer Id       : 1                   Creation Origin   : manual
Last Status Change: 08/28/2025 20:09:00 
Last Mgmt Change  : 08/28/2025 15:58:03 
Test Service      : No                  
Admin State       : Up                  Oper State        : Up
MTU               : 1514                
Vc Switching      : False               
SAP Count         : 1                   SDP Bind Count    : 0
Per Svc Hashing   : Disabled            Lbl Eth/IP L4 TEID: Disabled
Ignore MTU Mismat*: Disabled            
Vxlan Src Tep Ip  : N/A
Force QTag Fwd    : Disabled            
Lcl Switch Svc St : sap                 
Oper Group        : <none>              
 
-------------------------------------------------------------------------------
Service Access & Destination Points
-------------------------------------------------------------------------------
Identifier                               Type         AdmMTU  OprMTU  Adm  Opr
-------------------------------------------------------------------------------
sap:1/1/c4/1:516                         q-tag        1518    1518    Up   Up
===============================================================================
* indicates that the corresponding row element may have been truncated.
```

Announced SID for this service
```cpp
A:admin@R05-SR# /show service id "R05-R16_VPWS-SRv6" segment-routing-v6 detail

===============================================================================
Micro Segment Routing v6 Instance 1 Service 516
===============================================================================
Micro Segment Locator
 Type          Function  SID                                     Status
               Oper Func                                         
-------------------------------------------------------------------------------
uSID-Alg0-Locator
 uDX2          *-        2001:ac8:5:e014::                       ok
               57364                                             
===============================================================================
Legend: * - System allocated
```

Remote SID for this service received from R05
```cpp
A:admin@R16-IXR# /show service id "R05-R16_VPWS-SRv6" segment-routing-v6 destinations

===============================================================================
TEP, SID (InstanceA:admin@R05-SR# /show service id "R05-R16_VPWS-SRv6" segment-routing-v6 destinations

===============================================================================
TEP, SID (Instance 1)
===============================================================================
TEP Address                             Segment Id
-------------------------------------------------------------------------------
3ffe::b                                 2001:ac9:10:e010::
-------------------------------------------------------------------------------
Number of TEP, SID: 1
-------------------------------------------------------------------------------
===============================================================================

===============================================================================
Segment Routing v6 Ethernet Segment Dest (Instance 1)
===============================================================================
Eth SegId                                 Num. Macs     Last Update
-------------------------------------------------------------------------------
No Matching Entries
===============================================================================
```

uSID for this service
```cpp
A:admin@R05-SR# show router bgp routes evpn auto-disc tag 165 detail
===============================================================================
 BGP Router ID:10.0.0.5         AS:65000       Local AS:65000      
===============================================================================
 Legend -
 Status codes  : u - used, s - suppressed, h - history, d - decayed, * - valid
                 l - leaked, x - stale, > - best, b - backup, p - purge,
                 w - unused-weight-only
 Origin codes  : i - IGP, e - EGP, ? - incomplete

===============================================================================
BGP EVPN Auto-Disc Routes
===============================================================================
Original Attributes
 
Network        : n/a
Nexthop        : 3ffe::b
Path Id        : None                   
From           : 3ffe::7
Res. Nexthop   : fe80::1eef:6ff:fe00:0
Local Pref.    : 100                    Interface Name : toR07
Aggregator AS  : None                   Aggregator     : None
Atomic Aggr.   : Not Atomic             MED            : None
AIGP Metric    : None                   IGP Cost       : 41
Connector      : None
Community      : target:65000:516 l2-attribute:MTU: 1514 V: 0 M: 0 F: 0 C: 0
                 P: 0 B: 0
Cluster        : 10.0.0.7 10.0.0.12 10.0.0.11
Originator Id  : 10.0.20.16             Peer Router Id : 10.0.0.7
Origin         : IGP                    
Flags          : Used Valid Best 
Route Source   : Internal
AS-Path        : No As-Path
EVPN type      : AUTO-DISC              
ESI            : ESI-0
Tag            : 165                    
Route Dist.    : 10.0.20.16:516         
MPLS Label     : 57360                  
Route Tag      : 0                      
Neighbor-AS    : n/a
DB Orig Val    : N/A                    Final Orig Val : N/A
Source Class   : 0                      Dest Class     : 0
Add Paths Send : Default                
Last Modified  : 00h36m03s              
SRv6 TLV Type  : SRv6 L2 Service TLV (6)
SRv6 SubTLV    : SRv6 SID Information (1)
Sid            : 2001:ac9:10::
Full Sid       : 2001:ac9:10:e010::
Behavior       : End.uDX2 (65)
SRv6 SubSubTLV : SRv6 SID Structure (1)
Loc-Block-Len  : 32                     Loc-Node-Len   : 16
Func-Len       : 16                     Arg-Len        : 0
Tpose-Len      : 16                     Tpose-offset   : 48
 
Modified Attributes
 
Network        : n/a
Nexthop        : 3ffe::b
Path Id        : None                   
From           : 3ffe::7
Res. Nexthop   : fe80::1eef:6ff:fe00:0
Local Pref.    : 100                    Interface Name : toR07
Aggregator AS  : None                   Aggregator     : None
Atomic Aggr.   : Not Atomic             MED            : None
AIGP Metric    : None                   IGP Cost       : 41
Connector      : None
Community      : target:65000:516 l2-attribute:MTU: 1514 V: 0 M: 0 F: 0 C: 0
                 P: 0 B: 0
Cluster        : 10.0.0.7 10.0.0.12 10.0.0.11
Originator Id  : 10.0.20.16             Peer Router Id : 10.0.0.7
Origin         : IGP                    
Flags          : Used Valid Best 
Route Source   : Internal
AS-Path        : No As-Path
EVPN type      : AUTO-DISC              
ESI            : ESI-0
Tag            : 165                    
Route Dist.    : 10.0.20.16:516         
MPLS Label     : 57360                  
Route Tag      : 0                      
Neighbor-AS    : n/a
DB Orig Val    : N/A                    Final Orig Val : N/A
Source Class   : 0                      Dest Class     : 0
Add Paths Send : Default                
Last Modified  : 00h36m03s              
SRv6 TLV Type  : SRv6 L2 Service TLV (6)
SRv6 SubTLV    : SRv6 SID Information (1)
Sid            : 2001:ac9:10::
Full Sid       : 2001:ac9:10:e010::
Behavior       : End.uDX2 (65)
SRv6 SubSubTLV : SRv6 SID Structure (1)
Loc-Block-Len  : 32                     Loc-Node-Len   : 16
Func-Len       : 16                     Arg-Len        : 0
Tpose-Len      : 16                     Tpose-offset   : 48
 
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------
Routes : 1
===============================================================================
```

Full SID matches what is seen in R05 with SID `2001:ac9:10:e010::`
```cpp
A:admin@R16-IXR# /show router segment-routing-v6 micro-segment-local-sid

===============================================================================
Micro Segment Routing v6 Local SIDs
===============================================================================
SID                                               Type           Function
  Micro Segment Locator                                          
  Context                                                        
-------------------------------------------------------------------------------
2001:ac9:10::                                     uN             16
  uSID-Alg0-Locator
  None
2001:ac9:10:e010::                                uDX2           57360
  uSID-Alg0-Locator
  SvcId: 516 Name: R05-R16_VPWS-SRv6
2001:ac9:10:e011::                                uDX2           57361
  uSID-Alg0-Locator
  SvcId: 1316 Name: R13-R16_VPWS-SRv6
2001:ac9:10:e013::                                uA             57363
  uSID-Alg0-Locator
  None
-------------------------------------------------------------------------------
SIDs : 4
-------------------------------------------------------------------------------
===============================================================================
```

Routing Table
```cpp
A:admin@R05-SR# /show router route-table ipv6 2001:ac9:10:e010::    

===============================================================================
IPv6 Route Table (Router: Base)
===============================================================================
Dest Prefix[Flags]                            Type    Proto     Age        Pref
      Next Hop[Interface Name]                                    Metric   
-------------------------------------------------------------------------------
2001:ac9::/32                                 Remote  ISIS      00h03m42s  18
       fe80::1eef:6ff:fe00:0-"toR07"                                41
-------------------------------------------------------------------------------
No. of Routes: 1
Flags: n = Number of times nexthop is repeated
       B = BGP backup route available
       L = LFA nexthop available
       S = Sticky ECMP requested
===============================================================================
```

Tunnel Table
```cpp
A:admin@R05-SR# show router tunnel-table ipv6

===============================================================================
IPv6 Tunnel Table (Router: Base)
===============================================================================
Destination                                     Owner     Encap TunnelId  Pref
Nexthop                                         Color           Metric    
-------------------------------------------------------------------------------
2001:ac8:6::/48 [L]                             srv6-isis SRV6  524307    0
  fe80::1e59:5ff:fe00:0-"toR06"                                   11        
2001:ac8:7::/48 [L]                             srv6-isis SRV6  524308    0
  fe80::1eef:6ff:fe00:0-"toR07"                                   11        
2001:ac8:8::/48 [L]                             srv6-isis SRV6  524309    0
  fe80::1e59:5ff:fe00:0-"toR06"                                   21        
2001:ac8:9::/48 [L]                             srv6-isis SRV6  524310    0
  fe80::1eef:6ff:fe00:0-"toR07"                                   21        
2001:ac8:a::/48 [L]                             srv6-isis SRV6  524311    0
  fe80::1e59:5ff:fe00:0-"toR06"                                   31        
2001:ac8:b::/48 [L]                             srv6-isis SRV6  524312    0
  fe80::1eef:6ff:fe00:0-"toR07"                                   31        
2001:ac8:c::/48 [L]                             srv6-isis SRV6  524313    0
  fe80::1e59:5ff:fe00:0-"toR06"                                   41        
2001:ac8:e010::/48 [L]                          srv6-isis SRV6  524298    0
  fe80::1e59:5ff:fe00:0-"toR06"                                   10        
2001:ac8:e013::/48 [L]                          srv6-isis SRV6  524299    0
  fe80::1eef:6ff:fe00:0-"toR07"                                   10        
-------------------------------------------------------------------------------
Flags: B = BGP or MPLS backup hop available
       L = Loop-Free Alternate (LFA) hop available
       E = Inactive best-external BGP route
       k = RIB-API or Forwarding Policy backup hop
===============================================================================
```

IPv6 FIB
```cpp
A:admin@R05-SR# show router fib 1 ipv6

===============================================================================
FIB Display
===============================================================================
Prefix [Flags]                                              Protocol
  NextHop                                                   
-------------------------------------------------------------------------------
2001:ac8:5::/48                                             SRV6
  Blackhole                                                 
2001:ac8:5:e000::/51                                        SRV6
  fe80::201 (_tmnx_fpe_2.a)
2001:ac8:5:e010::/64                                        ISIS
  2001:ac8:e010::/48 (Transport:SRV6-ISIS:524298)
2001:ac8:5:e013::/64                                        ISIS
  2001:ac8:e013::/48 (Transport:SRV6-ISIS:524299)
2001:ac8:6::/48                                             ISIS
  2001:ac8:6::/48 (Transport:SRV6-ISIS:524307)
2001:ac8:7::/48                                             ISIS
  2001:ac8:7::/48 (Transport:SRV6-ISIS:524308)
2001:ac8:8::/48                                             ISIS
  2001:ac8:8::/48 (Transport:SRV6-ISIS:524309)
2001:ac8:9::/48                                             ISIS
  2001:ac8:9::/48 (Transport:SRV6-ISIS:524310)
2001:ac8:a::/48                                             ISIS
  2001:ac8:a::/48 (Transport:SRV6-ISIS:524311)
2001:ac8:b::/48                                             ISIS
  2001:ac8:b::/48 (Transport:SRV6-ISIS:524312)
2001:ac8:c::/48                                             ISIS
  2001:ac8:c::/48 (Transport:SRV6-ISIS:524313)
2001:ac8:e000::/35                                          SRV6
  fe80::201 (_tmnx_fpe_2.a)
2001:ac8:e010::/48                                          ISIS
  2001:ac8:e010::/48 (Transport:SRV6-ISIS:524298)
2001:ac8:e013::/48                                          ISIS
  2001:ac8:e013::/48 (Transport:SRV6-ISIS:524299)
2001:ac9::/32                                               ISIS
  fe80::1eef:6ff:fe00:0 (toR07)
3ffe::2/128                                                 ISIS
  fe80::1e59:5ff:fe00:0 (toR06)
3ffe::3/128                                                 ISIS
  fe80::1eff:2ff:fe00:85 (toR03)
3ffe::4/128                                                 ISIS
  fe80::1e59:5ff:fe00:0 (toR06)
3ffe::5/128                                                 LOCAL
  3ffe::5 (system)
3ffe::6/128                                                 ISIS
  fe80::1e59:5ff:fe00:0 (toR06)
3ffe::7/128                                                 ISIS
  fe80::1eef:6ff:fe00:0 (toR07)
3ffe::8/128                                                 ISIS
  fe80::1e59:5ff:fe00:0 (toR06)
3ffe::9/128                                                 ISIS
  fe80::1eef:6ff:fe00:0 (toR07)
3ffe::a/128                                                 ISIS
  fe80::1e59:5ff:fe00:0 (toR06)
3ffe::b/128                                                 ISIS
  fe80::1eef:6ff:fe00:0 (toR07)
3ffe::c/128                                                 ISIS
  fe80::1e59:5ff:fe00:0 (toR06)
3ffe::d/128                                                 ISIS
  fe80::1eef:6ff:fe00:0 (toR07)
3ffe::e/128                                                 ISIS
  fe80::1e59:5ff:fe00:0 (toR06)
3ffe::f/128                                                 ISIS
  fe80::1eef:6ff:fe00:0 (toR07)
3ffe::10/128                                                ISIS
  fe80::1eef:6ff:fe00:0 (toR07)
-------------------------------------------------------------------------------
Total Entries : 30
-------------------------------------------------------------------------------
===============================================================================
```